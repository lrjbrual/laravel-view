<link type="text/css" rel="stylesheet" href="{{asset('assets/css/pages/index.css')}}">

<div class="outer">
  <div class="inner bg-container">
  <div class="dataTables_processing2 loading_cards_ads" style="display:block;z-index: 99999"> <b>Loading cards </b><i class="fa fa-refresh fa-spin fa-fw"></i><span class="sr-only">Loading...</span></div>
    <div class="row widget_countup">
        <div class="col-xs-12 col-sm-6 col-xl-3">

            <div id="revenue_widget">
                <div class="front">
                    <div class="bg-primary p-d-15 b_r_5">
                        <div class="float-xs-right m-t-5">
                            <!-- <i class="fa fa-money"></i> -->
                        </div>
                        <div class="user_font">Revenue</div>
                        <div id="widget_countup1"></div>
                        <div class="previous_font">&nbsp;</div>
                    </div>
                </div>
                <div class="back">
                    <div class="bg-white b_r_5 section_border">
                        <div class="p-t-l-r-15">
                            <div class="float-xs-right m-t-5">
                                <!-- <i class="fa fa-money text-primary"></i> -->
                            </div>
                            <div class="widget_countup2_1" id="widget_countup12"></div>
                            <div>Revenue</div>
                        </div>

                        <div class="row">
                            <div class="col-lg-12">
                                <span id="visitsspark-chart1"></span>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>

        <div class="col-xs-12 col-sm-6 col-xl-3">

            <div id="ads_spend_widget">
                <div class="front">
                    <div class="bg-success p-d-15 b_r_5">
                        <div class="float-xs-right m-t-5">
                            <!-- <i class="fa fa-bar-chart"></i> -->
                        </div>
                        <div class="user_font">Ads Spend</div>
                        <div id="widget_countup2"></div>
                        <div class="previous_font">&nbsp;</div>
                    </div>
                </div>
                <div class="back">
                    <div class="bg-white b_r_5 section_border">
                        <div class="p-t-l-r-15">
                            <div class="float-xs-right m-t-5">
                                <!-- <i class="fa fa-bar-chart text-success"></i> -->
                            </div>
                            <div class="widget_countup2_2" id="widget_countup12"></div>
                            <div>Ads Spend</div>
                        </div>

                        <div class="row">
                            <div class="col-lg-12">
                                <span id="visitsspark-chart2"></span>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>

        <div class="col-xs-12 col-sm-6 col-xl-3">

            <div id="acos_widget">
                <div class="front">
                    <div class="bg-warning p-d-15 b_r_5">
                        <div class="float-xs-right m-t-5">
                            <!-- <i class="fa fa-dollar"></i> -->
                        </div>
                        <div class="user_font">ACOS</div>
                        <div id="widget_countup3"></div>
                        <div class="previous_font">&nbsp;</div>
                    </div>
                </div>
                <div class="back">
                    <div class="bg-white b_r_5 section_border">
                        <div class="p-t-l-r-15">
                            <div class="float-xs-right m-t-5">
                                <!-- <i class="fa fa-dollar text-warning"></i> -->
                            </div>
                            <div class="widget_countup2_3" id="widget_countup12"></div>
                            <div>ACOS</div>
                        </div>

                        <div class="row">
                            <div class="col-lg-12">
                                <span id="visitsspark-chart3"></span>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>

        <div class="col-xs-12 col-sm-6 col-xl-3">

            <div id="cpc_widget">
                <div class="front">
                    <div class="bg-danger p-d-15 b_r_5">
                        <div class="float-xs-right m-t-5">
                            <!-- <i class="fa fa-mouse-pointer"></i> -->
                        </div>
                        <div class="user_font">CPC</div>
                        <div id="widget_countup4"></div>
                        <div class="previous_font">&nbsp;</div>
                    </div>
                </div>
                <div class="back">
                    <div class="bg-white b_r_5 section_border">
                        <div class="p-t-l-r-15">
                            <div class="float-xs-right m-t-5">
                                <!-- <i class="fa fa-mouse-pointer text-danger"></i> -->
                            </div>
                            <div class="widget_countup2_4" id="widget_countup12"></div>
                            <div>CPC</div>
                        </div>

                        <div class="row">
                            <div class="col-lg-12">
                                <span id="visitsspark-chart4"></span>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
      </div>
      <br>
      <div class="row widget_countup">
        <div class="col-xs-12 col-sm-6 col-xl-3">

            <div id="impressions_widget">
                <div class="front">
                    <div class="bg-danger p-d-15 b_r_5">
                        <div class="float-xs-right m-t-5">
                            <!-- <i class="fa fa-thumbs-o-up"></i> -->
                        </div>
                        <div class="user_font">Impressions</div>
                        <div id="widget_countup5"></div>
                        <div class="previous_font">&nbsp;</div>
                    </div>
                </div>
                <div class="back">
                    <div class="bg-white b_r_5 section_border">
                        <div class="p-t-l-r-15">
                            <div class="float-xs-right m-t-5">
                                <!-- <i class="fa fa-thumbs-o-up text-danger"></i> -->
                            </div>
                            <div class="widget_countup2_5" id="widget_countup12"></div>
                            <div>Impressions</div>
                        </div>

                        <div class="row">
                            <div class="col-lg-12">
                                <span id="visitsspark-chart5"></span>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>

        <div class="col-xs-12 col-sm-6 col-xl-3">

            <div id="ctr_widget">
                <div class="front">
                    <div class="bg-warning p-d-15 b_r_5">
                        <div class="float-xs-right m-t-5">
                            <!-- <i class="fa fa-mouse-pointer"></i> -->
                        </div>
                        <div class="user_font">CTR</div>
                        <div id="widget_countup6"></div>
                        <div class="previous_font">&nbsp;</div>
                    </div>
                </div>
                <div class="back">
                    <div class="bg-white b_r_5 section_border">
                        <div class="p-t-l-r-15">
                            <div class="float-xs-right m-t-5">
                                <!-- <i class="fa fa-mouse-pointer text-warning"></i> -->
                            </div>
                            <div class="widget_countup2_6" id="widget_countup12"></div>
                            <div>CTR</div>
                        </div>

                        <div class="row">
                            <div class="col-lg-12">
                                <span id="visitsspark-chart6"></span>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>

        <div class="col-xs-12 col-sm-6 col-xl-3">

            <div id="clicks_widget">
                <div class="front">
                    <div class="bg-success p-d-15 b_r_5">
                        <div class="float-xs-right m-t-5">
                            <!-- <i class="fa fa-line-chart"></i> -->
                        </div>
                        <div class="user_font">Clicks</div>
                        <div id="widget_countup7"></div>
                        <div class="previous_font">&nbsp;</div>
                    </div>
                </div>
                <div class="back">
                    <div class="bg-white b_r_5 section_border">
                        <div class="p-t-l-r-15">
                            <div class="float-xs-right m-t-5">
                                <!-- <i class="fa fa-line-chart text-success"></i> -->
                            </div>
                            <div class="widget_countup2_7" id="widget_countup12"></div>
                            <div>Clicks</div>
                        </div>

                        <div class="row">
                            <div class="col-lg-12">
                                <span id="visitsspark-chart7"></span>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>

        <div class="col-xs-12 col-sm-6 col-xl-3">

            <div id="cr_widget">
                <div class="front">
                    <div class="bg-primary p-d-15 b_r_5">
                        <div class="float-xs-right m-t-5">
                            <!-- <i class="fa fa-area-chart"></i> -->
                        </div>
                        <div class="user_font">CR</div>
                        <div id="widget_countup8"></div>
                        <div class="previous_font">&nbsp;</div>
                    </div>
                </div>
                <div class="back">
                    <div class="bg-white b_r_5 section_border">
                        <div class="p-t-l-r-15">
                            <div class="float-xs-right m-t-5">
                                <!-- <i class="fa fa-area-chart text-primary"></i> -->
                            </div>
                            <div class="widget_countup2_8" id="widget_countup12"></div>
                            <div>CR</div>
                        </div>

                        <div class="row">
                            <div class="col-lg-12">
                                <span id="visitsspark-chart8"></span>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
      </div>
  </div>
</div>

<script type="text/javascript" src="{{asset('assets/js/pluginjs/jquery.sparkline.js')}}"></script>
<script type="text/javascript">
var isFilter = 0;
$(document).ready(function() {
  
});

function getCardsData(){
  var filter_date_start = $('#start_date').val();
  var filter_date_end = $('#end_date').val();
  var _token = "{{ csrf_token() }}";
  var data = { _token:_token, filter_date_start:filter_date_start, filter_date_end:filter_date_end };
  if(isFilter == 1){
      var filter_imp = $('#filter_imp_min').val()+"-"+$('#filter_imp_max').val();
      var filter_clicks = $('#filter_clicks_min').val()+"-"+$('#filter_clicks_max').val();
      var filter_ctr = $('#filter_ctr_min').val()+"-"+$('#filter_ctr_max').val();
      var filter_total_spend = $('#filter_total_spend_min').val()+"-"+$('#filter_total_spend_max').val();
      var filter_avg_cpc = $('#filter_avg_cpc_min').val()+"-"+$('#filter_avg_cpc_max').val();
      var filter_acos = $('#filter_acos_min').val()+"-"+$('#filter_acos_max').val();
      var filter_conv_rate = $('#filter_conv_rate_min').val()+"-"+$('#filter_conv_rate_max').val();
      var filter_revenue = $('#filter_revenue_min').val()+"-"+$('#filter_revenue_max').val();
      var filter_country = ($('#filter_country').val()) ? $('#filter_country').val().toString() : '';
      var filter_camp_type = ($('#filter_camp_type').val()) ? $('#filter_camp_type').val().toString() : '';
      var filter_camp_name = ($('#filter_camp_name').val()) ? $('#filter_camp_name').val().toString() : '';
      var filter_ad_group = ($('#filter_ad_group').val()) ? $('#filter_ad_group').val().toString() : '';
      var filter_keyword = $('#filter_keyword').val();
      var filter_recommendation = ($('#filter_recommendation').val()) ? $('#filter_recommendation').val().toString() : '';
      data = { _token: _token, filter_date_start: filter_date_start, filter_date_end:filter_date_end, filter_imp:filter_imp, filter_clicks:filter_clicks, filter_ctr:filter_ctr, filter_total_spend:filter_total_spend, filter_avg_cpc:filter_avg_cpc, filter_acos:filter_acos, filter_conv_rate:filter_conv_rate, filter_country:filter_country, filter_camp_type:filter_camp_type, filter_camp_name:filter_camp_name, filter_keyword:filter_keyword, filter_revenue:filter_revenue, filter_ad_group:filter_ad_group, filter_recommendation:filter_recommendation };
    }
  $.ajax({url: "getAdGraph", type: 'POST', data: data, success: function(result){
     var response = jQuery.parseJSON(result);
     setCardsData(response);
     $('#start_date').val(response['date_start']);
     $('#end_date').val(response['date_end']);
  }
  });
}

function numberForHuman(n) {
    var parts = n.toString().split(".");
    parts[0] = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    return parts.join(".");
}

function setCardsData(response) {

      $("#quick_filter").html('Filter');
      
      $('.loading_cards_ads').hide();

      $("#revenue_widget").flip({
          axis: 'x',
          trigger: 'click'
      });

      $("#ads_spend_widget").flip({
          axis: 'x',
          trigger: 'click'
      });

      $("#acos_widget").flip({
          axis: 'x',
          trigger: 'click'
      });

      $("#cpc_widget").flip({
          axis: 'x',
          trigger: 'click'
      });

      $("#impressions_widget").flip({
          axis: 'x',
          trigger: 'click'
      });

      $("#ctr_widget").flip({
          axis: 'x',
          trigger: 'click'
      });

      $("#clicks_widget").flip({
          axis: 'x',
          trigger: 'click'
      });

      $("#cr_widget").flip({
          axis: 'x',
          trigger: 'click'
      });

      var options = {
          useEasing: true,
          useGrouping: true,
          decimal: '.',
          prefix: '',
          suffix: ''
      };
      var options2 = {
          useEasing: true,
          useGrouping: false,
          decimal: '.',
          prefix: '',
          suffix: '%'
      };

      new CountUp("widget_countup1", 0, response['revenue_t'], 2, 5.0, options).start();
      new CountUp("widget_countup2", 0, response['total_spend_t'], 2, 5.0, options).start();
      new CountUp("widget_countup3", 0, response['acos_t'], 2, 5.0, options2).start();
      new CountUp("widget_countup4", 0, response['average_cpc_t'], 2, 5.0, options).start();
      new CountUp("widget_countup5", 0, response['impressions_t'], 0, 5.0, options).start();
      new CountUp("widget_countup6", 0, response['ctr_t'], 2, 5.0, options2).start();
      new CountUp("widget_countup7", 0, response['clicks_t'], 0, 5.0, options).start();
      new CountUp("widget_countup8", 0, response['cr_t'], 2, 5.0, options2).start();
      
      $(".widget_countup2_1").html(numberForHuman(response['revenue_t']));
      $(".widget_countup2_2").html(numberForHuman(response['total_spend_t']));
      $(".widget_countup2_3").html(numberForHuman(response['acos_t'])+'%');
      $(".widget_countup2_4").html(numberForHuman(response['average_cpc_t']));
      $(".widget_countup2_5").html(numberForHuman(response['impressions_t']));
      $(".widget_countup2_6").html(numberForHuman(response['ctr_t'])+'%');
      $(".widget_countup2_7").html(numberForHuman(response['clicks_t']));
      $(".widget_countup2_8").html(numberForHuman(response['cr_t'])+'%');
      
      $("#visitsspark-chart1").sparkline(response['revenue'], {
          type: 'line',
          width: '100%',
          height: '48',
          lineColor: '#4fb7fe',
          fillColor: '#e7f5ff',
          tooltipSuffix: 'Revenue'
      });

      $("#visitsspark-chart2").sparkline(response['total_spend'], {
          type: 'line',
          width: '100%',
          height: '48',
          lineColor: '#4fb7fe',
          fillColor: '#e7f5ff',
          tooltipSuffix: 'Ads Spend'
      });

      $("#visitsspark-chart3").sparkline(response['acos'], {
          type: 'line',
          width: '100%',
          height: '48',
          lineColor: '#4fb7fe',
          fillColor: '#e7f5ff',
          tooltipSuffix: 'ACoS'
      });

      $("#visitsspark-chart4").sparkline(response['average_cpc'], {
          type: 'line',
          width: '100%',
          height: '48',
          lineColor: '#4fb7fe',
          fillColor: '#e7f5ff',
          tooltipSuffix: 'CPC'
      });

      $("#visitsspark-chart5").sparkline(response['impressions'], {
          type: 'line',
          width: '100%',
          height: '48',
          lineColor: '#4fb7fe',
          fillColor: '#e7f5ff',
          tooltipSuffix: 'Impressions'
      });

      $("#visitsspark-chart6").sparkline(response['ctr'], {
          type: 'line',
          width: '100%',
          height: '48',
          lineColor: '#4fb7fe',
          fillColor: '#e7f5ff',
          tooltipSuffix: 'CTR'
      });

      $("#visitsspark-chart7").sparkline(response['clicks'], {
          type: 'line',
          width: '100%',
          height: '48',
          lineColor: '#4fb7fe',
          fillColor: '#e7f5ff',
          tooltipSuffix: 'Clicks'
      });

      $("#visitsspark-chart8").sparkline(response['cr'], {
          type: 'line',
          width: '100%',
          height: '48',
          lineColor: '#4fb7fe',
          fillColor: '#e7f5ff',
          tooltipSuffix: 'CR'
      });
}

</script>
<style media="screen">
.jqstooltip {
  width: auto !important;
  height: auto !important;
}

canvas {
  width: 100% !important;
}
</style>
